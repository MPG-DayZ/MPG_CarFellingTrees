# MPG_CarFellingTrees

Простой скрипт для реализации механики валки деревьев для любой машины через настройку в config.cpp.

## Параметры конфигурации

### MPG_FellingEnabled

Включает или отключает механику валки деревьев для данного транспортного средства.

По умолчанию параметр выключен.

Пример: `MPG_FellingEnabled = true;` (включено)

### MPG_FellingAttachmentSlots

1. Определяет, какие слоты аттачментов должны быть заполнены для валки деревьев.
2. Машина сможет валить деревья только если все указанные слоты содержат незаруиненные аттачменты.
3. Если параметр не указан или пуст, проверка аттачментов не выполняется.

Пример: `MPG_FellingAttachmentSlots[] = {"BullBar_Slot", "Bumper_Slot", "Reinforcement_Slot"};`

### MPG_FellingMinSpeed

Минимальная скорость (в км/ч), при которой транспортное средство может валить деревья.

По умолчанию: `10.0`

Пример: `MPG_FellingMinSpeed = 15.0;`

### MPG_FellingMinImpulse

Минимальный импульс столкновения, необходимый для валки дерева.

По умолчанию: `2000.0`

Пример: `MPG_FellingMinImpulse = 2500.0;`

## Принцип работы

Когда транспортное средство сталкивается с объектом, выполняется следующая последовательность проверок:

1. Проверка, включена ли механика валки деревьев (`MPG_FellingEnabled`).
2. Проверка, включен ли двигатель транспортного средства.
3. Проверка, достаточна ли скорость транспортного средства (`MPG_FellingMinSpeed`).
4. Проверка, достаточен ли импульс столкновения (`MPG_FellingMinImpulse`).
5. Проверка наличия и целостности всех требуемых аттачментов (`MPG_FellingAttachmentSlots`).
6. Проверка, является ли объект столкновения деревом и может ли оно быть повалено.

Если все условия выполнены, дерево будет повалено с соответствующим звуковым эффектом в зависимости от типа дерева (
твердое или мягкое).

## Пример реализации валки деревьев для ванильного хаммера

```c
class CfgPatches {
  class MPG_CarFellingTest {
    units[] = {};
    weapons[] = {};
    requiredVersion = 0.1;
    requiredAddons[] = { "DZ_Data",
                         "DZ_Scripts",
                         // Не забываем указать зависимость на мод MPG_CarFellingTrees
                         "MPG_CarFellingTrees" };
  };
};

class CfgVehicles {
  class CarScript;
  class Offroad_02 : CarScript {
    // Может ли машина валить деревья.
    // По сути этого параметра достаточно для того, что бы машина могла валить деревья
    MPG_FellingEnabled = true;

    // -------------------------------
    // Далее необязательные параметры:
    // -------------------------------

    // Какие слоты должны быть заполнены для того, что бы валилось дерево,
    // если не указано, то параметр не будет учитываться
    MPG_FellingAttachmentSlots[] = { "Offroad_02_Trunk" };

    // Минимальная скорость, при которой машина может валить деревья (если не указать, будет 10 км/ч)
    MPG_FellingMinSpeed = 15;

    // Минимальный импульс, при котором машина может валить деревья (если не указать, будет 2000)
    MPG_FellingMinImpulse = 200;
  };
};
```